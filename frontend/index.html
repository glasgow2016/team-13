<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Code for Good</title>

    <!-- Fonts from TypeKit -->
    <script>!function(e,t,n,a,c,l,m,o,d,f,h,i){c[l]&&(d=e.createElement(t),d[n]=c[l],e[a]("head")[0].appendChild(d),e.documentElement.className+=" wf-cached"),function s(){for(d=e[a](t),f="",h=0;h<d.length;h++)i=d[h][n],i.match(m)&&(f+=i);f&&(c[l]="/**/"+f),setTimeout(s,o+=o)}()}(document,"style","innerHTML","getElementsByTagName",localStorage,"tk",/^@font|^\.tk-/,100);</script>
    <script src="https://use.typekit.net/ubb7zko.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

    <!-- jQuery Fullpage plugin -->
    <script src="public/jquery.fullpage.js"></script>
    <link rel="stylesheet" href="public/jquery.fullpage.css">

    <!-- Autocomplete library -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery.devbridge-autocomplete/1.2.21/jquery.autocomplete.js"></script>

    <!-- Font Awesome library -->
    <link rel="stylesheet" href="public/font-awesome.min.css">

    <!-- VUE.js -->
    <script src="https://unpkg.com/vue@2.0.5/dist/vue.js"></script>

    <!-- Main style.css -->
    <link rel="stylesheet" href="public/style.css">

</head>
<body class="page">
<div id="fullpage">

    <div class="step__wrapper section">
        <div class="step">
            <h2>Person</h2>
            <div class="choices" data-field="person">
                <div data-val="pwc"><span><i class="fa fa-heartbeat" aria-hidden="true"></i>PwC</span></div>
                <div data-val="carer"><span><i class="fa fa-medkit" aria-hidden="true"></i>Carer</span></div>
                <div data-val="professional"><span><i class="fa fa-user" aria-hidden="true"></i>Professional</span></div>
                <div data-val="architectural"><span><i class="fa fa-building-o" aria-hidden="true"></i>Architectural</span></div>
                <div data-val="international"><span><i class="fa fa-globe" aria-hidden="true"></i>International</span></div>
                <div data-val="other-visitor"><span><i class="fa fa-question-circle" aria-hidden="true"></i>Other Visitor</span></div>
            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Visit Type</h2>
            <div class="choices" style="max-width: 400px;" data-field="visit-type">
                <div data-val="new"><span><i class="fa fa-user-plus" aria-hidden="true"></i>New</span></div>
                <div data-val="returning"><span><i class="fa fa-undo" aria-hidden="true"></i>Returning</span></div>

            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Gender</h2>
            <div class="choices" style="max-width: 400px;" data-field="gender">
                <div data-val="male"><span><i class="fa fa-mars" aria-hidden="true"></i>Male</span></div>
                <div data-val="female"><span><i class="fa fa-venus" aria-hidden="true"></i>Female</span></div>
            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Age</h2>
            <div class="choices" style="max-width: 400px;" data-field="age">
                <div data-val="under-18"><span>Under 18</span></div>
                <div data-val="over-18"><span>Over 18</span></div>
            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Cancer Site</h2>
            <div class="choices small" data-field="cancer-site">
                <div data-val="brain/cns"><span>Brain/CNS</span></div>
                <div data-val="breast"><span>Breast</span></div>
                <div data-val="gynae"><span>Gynae</span></div>
                <div data-val="head/neck"><span>Head/Neck</span></div>
                <div data-val="haemat"><span>Haemat</span></div>
                <div data-val="live"><span>Liver</span></div>
                <div data-val="lower-gi"><span>Lower GI</span></div>
                <div data-val="lung"><span>Lung</span></div>
                <div data-val="pancreatic"><span>Pancreatic</span></div>
                <div data-val="prostate"><span>Prostate</span></div>
                <div data-val="rare"><span>Rare</span></div>
                <div data-val="sarcoma"><span>Sarcoma</span></div>
                <div data-val="skin/mel"><span>Skin/Mel</span></div>
                <div data-val="testicular"><span>Testicular</span></div>
                <div data-val="unknown-primary"><span>Unknown Primary</span></div>
                <div data-val="upper-gi"><span>Upper GI</span></div>
                <div data-val="urolog"><span>Urolog</span></div>
                <div data-val="not-stated"><span>Not Stated</span></div>
            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Journey Stage</h2>
            <div class="choices small" data-field="journey-stage">
                <div class="timeline__tag" data-val="pre-diagnosis"><span>Pre-Diagnosis</span></div>
                <div class="timeline__tag" data-val="post-treatment"><span>Post Treatment</span></div>
                <div class="timeline__tag" data-val="palliative-care"><span>Palliative Care</span></div>
                <div class="timeline__tag" data-val="bereaved"><span>Bereaved</span></div>
                <div class="timeline__tag" data-val="curative-intent"><span>Curative Intent</span></div>
                <div class="timeline__tag" data-val="non-curative-intent"><span>Non-Curative Intent</span></div>
                <div class="timeline__tag" data-val="end-of-life"><span>End of Life</span></div>
                <div class="timeline__tag" data-val="not-stated"><span>Not Stated</span></div>
            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Nature of Visit</h2>
            <div class="choices small" data-field="nature-of-visit">
                <div class="timeline__tag" data-val="booked"><span>Booked</span></div>
                <div class="timeline__tag" data-val="drop-in"><span>Drop-In</span></div>
                <div class="timeline__tag" data-val="programme"><span>Programme</span></div>
                <div class="timeline__tag" data-val="e-mail-support"><span>E-mail Support</span></div>
                <div class="timeline__tag" data-val="fundraising"><span>Fundraising</span></div>
                <div class="timeline__tag" data-val="outreach"><span>Outreach</span></div>
                <div class="timeline__tag" data-val="telephone-support"><span>Telephone Support</span></div>

            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Activities</h2>
            <div class="activities" >
                <div id="selected">
                    <span v-for="activity in selected">
                        {{ activity.value }}
                    </span>
                </div>
                <input type="text" name="country" id="autocomplete" placeholder="SEARCH"/>
            </div>
        </div>
    </div>

    <div class="step__wrapper section">
        <div class="step">
            <h2>Submission</h2>
            <div class="form" >
                <table>
                    <tr>
                        <td>Person:</td>
                        <td data-res="person"></td>
                    </tr>
                    <tr>
                        <td>Visit Type</td>
                        <td data-res="visit-type"></td>
                    </tr>
                    <tr>
                        <td>Gender</td>
                        <td data-res="gender"></td>
                    </tr>
                    <tr>
                        <td>Age</td>
                        <td data-res="age"></td>
                    </tr>
                    <tr>
                        <td>Cancer Site</td>
                        <td data-res="cancer-site"></td>
                    </tr>
                    <tr>
                        <td>Journey State</td>
                        <td data-res="journey-stage"></td>
                    </tr>
                    <tr>
                        <td>Nature of Visit</td>
                        <td data-res="nature-of-visit"></td>
                    </tr>
                    <tr>
                        <td>Activities</td>
                        <td data-res="activities"></td>
                    </tr>
                </table>
                <button>Submit</button>
            </div>
        </div>
    </div>

</div>
<div class="footer">
    <span class="back"><a href="#">BACK</a></span>
    <span class="next"><a href="#q2">NEXT</a></span>
</div>
<script>
    $('.choices > div').on('click', function () {
        var current = $(this);
        if(!current.hasClass('active')) {
            current.parent().find('div').removeClass('active');
            current.addClass('active');
        } else {
            current.removeClass('active');
        }

        updateState();
    });

    var state = {};

    function updateState() {
        var person = $('[data-field="person"]').find('.active').attr('data-val') || "";
        var visitType = $('[data-field="visit-type"]').find('.active').attr('data-val') || "";
        var age = $('[data-field="age"]').find('.active').attr('data-val') || "";
        var gender = $('[data-field="gender"]').find('.active').attr('data-val') || "";
        var cancerSite = $('[data-field="cancer-site"]').find('.active').attr('data-val') || "";
        var journeyStage = $('[data-field="journey-stage"]').find('.active').attr('data-val') || "";
        var natureOfVisit = $('[data-field="nature-of-visit"]').find('.active').attr('data-val') || "";
        var activities = app4.selected;

        state["person"] = person;
        state["visit_type"] = visitType;
        state["gender"] = gender;
        state["age"] = age;
        state["cancer_site"] = cancerSite;
        state["journey_stage"] = journeyStage;
        state["nature_of_visit"] = natureOfVisit;
        state["activities"] = activities;

        console.log(JSON.stringify(state));


        updateForm();
    }

    function updateForm() {
        $('[data-res="activities"]').html('');
        $('[data-res="person"]').html(state.person);
        $('[data-res="visit-type"]').html(state.visitType);
        $('[data-res="gender"]').html(state.gender);
        $('[data-res="age"]').html(state.age);
        $('[data-res="cancer-site"]').html(state.cancerSite);
        $('[data-res="journey-stage"]').html(state.journeyStage);
        $('[data-res="nature-of-visit"]').html(state.natureOfVisit);
        state.activities.forEach(function(el) {
            $('[data-res="activities"]').append('<span>' + el.value + '</span>');
        });

    }
    
    $('button').on('click', function () {

        var settings = {
            "async": true,
            "crossDomain": true,
            "url": "http://localhost:8000/",
            "method": "POST",
            "headers": {
                "content-type": "application/json",
                "cache-control": "no-cache",
            },
            "processData": false,
            "data": JSON.stringify(state)
        }

        $.ajax(settings).done(function (response) {
            console.log(response);
            //todo
        });
        
    })
    
    var activities = [
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Bereavement"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Family and Friends"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG General"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Men's"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Secondary Cancer"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Young Person's"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Young Women's"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Brain"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Breast"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Gynae"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Haematology"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Head/Neck"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Laryngectomy"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Lower GI"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Lung"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Lymphoedema"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Myeloma"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Prostate"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Rare"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Sarcoma"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Upper GI"
        },
        {
            "category": "Psychological Support",
            "isCore": true,
            "value": "Psych Support - Couple"
        },
        {
            "category": "Psychological Support",
            "isCore": true,
            "value": "Psych Support - Family"
        },
        {
            "category": "Psychological Support",
            "isCore": true,
            "value": "Psych Support - Individual"
        },
        {
            "category": "Benefits Advice",
            "isCore": true,
            "value": "Benefits - Couple"
        },
        {
            "category": "Benefits Advice",
            "isCore": true,
            "value": "Benefits - Family"
        },
        {
            "category": "Benefits Advice",
            "isCore": true,
            "value": "Benefits - Individual"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Benefits Workshop"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Caring for Someone with Cancer"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "enetics"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Getting Started with Cancer Treatment"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Kids Days"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Lecture Series"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Look Good Feel Better"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Managing Stress"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Bereavement"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Family and Friends"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG General"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Men's"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Secondary Cancer"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Young Person's"
        },
        {
            "category": "Facilitated Support Groups",
            "isCore": true,
            "value": "FSG Young Women's"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Brain"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Breast"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Gynae"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Haematology"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Head/Neck"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Laryngectomy"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Lower GI"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Lung"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Lymphoedema"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Myeloma"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Prostate"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Rare"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Sarcoma"
        },
        {
            "category": "Networking Group",
            "isCore": true,
            "value": "NG Upper GI"
        },
        {
            "category": "Psychological Support",
            "isCore": true,
            "value": "Psych Support - Couple"
        },
        {
            "category": "Psychological Support",
            "isCore": true,
            "value": "Psych Support - Family"
        },
        {
            "category": "Psychological Support",
            "isCore": true,
            "value": "Psych Support - Individual"
        },
        {
            "category": "Benefits Advice",
            "isCore": true,
            "value": "Benefits - Couple"
        },
        {
            "category": "Benefits Advice",
            "isCore": true,
            "value": "Benefits - Family"
        },
        {
            "category": "Benefits Advice",
            "isCore": true,
            "value": "Benefits - Individual"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Benefits Workshop"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Caring for Someone with Cancer"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "enetics"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Getting Started with Cancer Treatment"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Kids Days"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Lecture Series"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Look Good Feel Better"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Managing Stress"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Talking Heads: Managing Hair Loss"
        },
        {
            "category": "C&W",
            "isCore": true,
            "value": "Where Now?"
        },
        {
            "category": "Sessional",
            "isCore": true,
            "value": "Creative Writing"
        },
        {
            "category": "Sessional",
            "isCore": true,
            "value": "Expressive art"
        },
        {
            "category": "Sessional",
            "isCore": true,
            "value": "Nutrition"
        },
        {
            "category": "Sessional",
            "isCore": true,
            "value": "Relaxation"
        },
        {
            "category": "Sessional",
            "isCore": true,
            "value": "Tai Chi/Qi Gong"
        },
        {
            "category": "Sessional",
            "isCore": true,
            "value": "Yoga"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Auricular Acupuncture"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Bereavement Course"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Cancer in the Workplace"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Fatigue Management"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Gardening"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Gentle Exercise"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Introduction to Radiotherapy"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Living With and Beyond Prostate Cancer"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Meditation"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Mind over Mood"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Mindfulness"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Music Therapy/Choir"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Nordic Walking"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Pilates"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Prosthesis"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Scrapbooking"
        },
        {
            "category": "Additional",
            "isCore": false,
            "value": "Sleep"
        }
    ]

    $('#autocomplete').autocomplete({
        lookup: activities,
        onSelect: function (suggestion) {
            $(this).val('');
            if(app4.selected.length < 3) {
                app4.selected.push({ value: suggestion.value });
                updateState();
            }
        }
    });

    $('#fullpage').fullpage({
        onLeave: function(index, nextIndex, direction){
            //add pagination controls logic here
        }
    });

    $('.back').on('click', function (e) {
        e.preventDefault();
        $.fn.fullpage.moveSectionUp();
    });

    $('.next').on('click', function (e) {
        e.preventDefault();
        $.fn.fullpage.moveSectionDown();
    });

    //var selected = [];

    var app4 = new Vue({
        el: '#selected',
        data: {
            selected: [ ]
        }
    })

    $(document).on('click', '#selected span', function () {
        var value = $(this).text().trim();
        app4.selected = app4.selected.filter(function (el) {
            return el.value !== value;
        });
        updateState();
    });


</script>
</body>
</html>